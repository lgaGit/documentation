<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-team-oneil/tosync-plugin">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">TOSync WordPress Plugin | LGA Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://lgagit.github.io/documentation/team-oneil/tosync-plugin"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TOSync WordPress Plugin | LGA Documentation"><meta data-rh="true" name="description" content="This plugin was made to handle the syncing of order &amp; booking data to Team O&#x27;Neil&#x27;s HubSpot account."><meta data-rh="true" property="og:description" content="This plugin was made to handle the syncing of order &amp; booking data to Team O&#x27;Neil&#x27;s HubSpot account."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lgagit.github.io/documentation/team-oneil/tosync-plugin"><link data-rh="true" rel="alternate" href="https://lgagit.github.io/documentation/team-oneil/tosync-plugin" hreflang="en"><link data-rh="true" rel="alternate" href="https://lgagit.github.io/documentation/team-oneil/tosync-plugin" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bf80d3ed.css">
<link rel="preload" href="/assets/js/runtime~main.df9a3e64.js" as="script">
<link rel="preload" href="/assets/js/main.edae62a8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_gmhD">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/lgalogo.png" alt="My Site Logo" class="themedImage_yIPB themedImage--light_N9JR"><img src="/img/lgalogo.png" alt="My Site Logo" class="themedImage_yIPB themedImage--dark_j_kT"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/intro">Docs</a><a href="https://www.lgamediagroup.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Website</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lgaGit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_hI8R"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_X3tF colorModeToggle_zZzY"><button class="clean-btn toggleButton_y2r0 toggleButtonDisabled_OhKs" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_zGk_"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wRjM"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_sM1E"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_FzYm"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_MWOi" type="button"></button><div class="docPage_JQPd"><aside class="theme-doc-sidebar-container docSidebarContainer_qOO8"><div class="sidebar_FA2_"><nav class="menu thin-scrollbar menu_ojk7"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intro">LGA Docs Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/team-oneil">Team O&#x27;Neil</a><button aria-label="Toggle the collapsible sidebar category &#x27;Team O&#x27;Neil&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/team-oneil/tosync-plugin">TOSync WordPress Plugin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/riverwalk-resort">RiverWalk Resort</a><button aria-label="Toggle the collapsible sidebar category &#x27;RiverWalk Resort&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/innseason-resort">InnSeason Resort</a><button aria-label="Toggle the collapsible sidebar category &#x27;InnSeason Resort&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_L5Tm"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_yZ4_"><div class="docItemContainer_ouwD"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__wBb" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_i6v0"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/team-oneil"><span itemprop="name">Team O&#x27;Neil</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TOSync WordPress Plugin</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_VPIp theme-doc-toc-mobile tocMobile_IF1V"><button type="button" class="clean-btn tocCollapsibleButton_gHDh">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Introduction</h1><p>This plugin was made to handle the syncing of order &amp; booking data to Team O&#x27;Neil&#x27;s HubSpot account.</p><p>Orders that are considered &quot;On Hold&quot; or &quot;Failed&quot; are <em>not</em> imported.</p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="technologies-used">Technologies Used<a class="hash-link" href="#technologies-used" title="Direct link to heading">​</a></h2><ul><li>WordPress (<a href="https://www.teamoneil.com" target="_blank" rel="noopener noreferrer">https://www.teamoneil.com</a>)</li><li>HubSpot</li><li>HubSpot API</li><li>PHP</li><li>ENV file to hold API Key.</li></ul><h2 class="anchor anchorWithStickyNavbar_UK3M" id="repository">Repository<a class="hash-link" href="#repository" title="Direct link to heading">​</a></h2><p>Code for this plugin can be found at the following GitHub location:</p><p><a href="https://github.com/lgaGit/TOSync" target="_blank" rel="noopener noreferrer">https://github.com/lgaGit/TOSync</a></p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="server-directory">Server Directory<a class="hash-link" href="#server-directory" title="Direct link to heading">​</a></h2><p>The Plugin is loaded onto the live Team O&#x27;Neil server at the following location:</p><p><em>/wp-content/plugins/TOSync</em></p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="build-instructions">Build Instructions<a class="hash-link" href="#build-instructions" title="Direct link to heading">​</a></h2><p>None. Runs off of the Team O&#x27;Neil WordPress PHP server.</p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="core-functions">Core Functions<a class="hash-link" href="#core-functions" title="Direct link to heading">​</a></h2><p>printout() - Runs the plugin on each order update.</p><p>neworder_creation($order_id) - Runs the plugin on each order creation</p><p>neworder_delegator($order_id, $order) - Function that runs the plugin.</p><p>mainplugin($orderid, $order) - Runs the main plugin.</p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="useful-functions">Useful Functions<a class="hash-link" href="#useful-functions" title="Direct link to heading">​</a></h2><p>write_to_log(&#x27;message) - Logs to the hubspotlog.txt file.</p><h2 class="anchor anchorWithStickyNavbar_UK3M" id="known-issues">Known Issues<a class="hash-link" href="#known-issues" title="Direct link to heading">​</a></h2><h4 class="anchor anchorWithStickyNavbar_UK3M" id="partial-payments">Partial Payments<a class="hash-link" href="#partial-payments" title="Direct link to heading">​</a></h4><p>Partial Payment orders were not importing into HubSpot correctly, due to WooCommerce not passing into the order complete hook the parent order. There is currently a delegation function
to try to retrieve the parent order from the partial payment order:
$order = get_woocommerce_order($order_id);</p><div class="language-php codeBlockContainer_JzVX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_VW57"><pre tabindex="0" class="prism-code language-php codeBlock_x_B2 thin-scrollbar"><code class="codeBlockLines__aST"><span class="token-line" style="color:#393A34"><span class="token plain">    $orderdata = $order-&gt;get_data();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $order_parent_id = $orderdata[&#x27;parent_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write_to_log(&#x27;Parent ID: &#x27; . $order_parent_id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($order_parent_id != 0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $parentorder = get_woocommerce_order($order_parent_id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainplugin($order_parent_id, $parentorder);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainplugin($order_id, $order);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($order_parent_id != 0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $parentorder = get_woocommerce_order($order_parent_id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainplugin($order_parent_id, $parentorder);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainplugin($order_id, $order);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup_hjh5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_bkap" aria-hidden="true"><svg class="copyButtonIcon_DDzq" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LAOA" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If a Partial Payment doesn&#x27;t correctly link to HubSpot, the fix is the following steps:</p><ol><li>Delete the deal in HubSpot</li><li>Open the order on WooCommerce</li><li>Click update</li></ol><p>This will force a update to the database and HubSpot.</p><h4 class="anchor anchorWithStickyNavbar_UK3M" id="products">Products<a class="hash-link" href="#products" title="Direct link to heading">​</a></h4><p>When a new product is created by Team O&#x27;Neil, it needs to be added to the code base in order to be able to be imported into HubSpot. This involves creating the product within HubSpot and then
retrieving the product number, of which is then added to the <code>set_product_id</code> switch case function. For example:</p><div class="language-php codeBlockContainer_JzVX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_VW57"><pre tabindex="0" class="prism-code language-php codeBlock_x_B2 thin-scrollbar"><code class="codeBlockLines__aST"><span class="token-line" style="color:#393A34"><span class="token plain">    // solar turbines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case 37106:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return 1407904381;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            break;</span><br></span></code></pre><div class="buttonGroup_hjh5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_bkap" aria-hidden="true"><svg class="copyButtonIcon_DDzq" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LAOA" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Solar Turbines are identified in the switch case statement with two ids:</p><ul><li>37106 - Retrieved from WooCommerce Product Admin Screen Link (<a href="https://teamoneil.com/wp-admin/post.php?post=37106&amp;action=edit" target="_blank" rel="noopener noreferrer">https://teamoneil.com/wp-admin/post.php?post=37106&amp;action=edit</a>)</li><li>1407904381 - Retrieved from HubSpot API Call to the products endpoint for Team O&#x27;Neil. (<a href="https://api.hubapi.com/crm/v3/objects/products?limit=10&amp;archived=false&amp;hapikey=YOUR_HUBSPOT_API_KEY" target="_blank" rel="noopener noreferrer">https://api.hubapi.com/crm/v3/objects/products?limit=10&amp;archived=false&amp;hapikey=YOUR_HUBSPOT_API_KEY</a>)</li></ul><p>HubSpot Product API Documentation is found at <a href="https://developers.hubspot.com/docs/api/crm/products" target="_blank" rel="noopener noreferrer">https://developers.hubspot.com/docs/api/crm/products</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/category/team-oneil"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Team O&#x27;Neil</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/category/riverwalk-resort"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">RiverWalk Resort</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_mNcy thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#technologies-used" class="table-of-contents__link toc-highlight">Technologies Used</a></li><li><a href="#repository" class="table-of-contents__link toc-highlight">Repository</a></li><li><a href="#server-directory" class="table-of-contents__link toc-highlight">Server Directory</a></li><li><a href="#build-instructions" class="table-of-contents__link toc-highlight">Build Instructions</a></li><li><a href="#core-functions" class="table-of-contents__link toc-highlight">Core Functions</a></li><li><a href="#useful-functions" class="table-of-contents__link toc-highlight">Useful Functions</a></li><li><a href="#known-issues" class="table-of-contents__link toc-highlight">Known Issues</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/lgaGit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_hI8R"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 LGA Media Group.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.df9a3e64.js"></script>
<script src="/assets/js/main.edae62a8.js"></script>
</body>
</html>